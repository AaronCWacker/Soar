#!/bin/sh

get_seed() {
	#date +"%N"
	echo 1
}

if [ -z "$1" ]
then
	echo choose either train or test >&2
	exit 1
fi

case "$1" in
train)
	export SVS_SAVE_MODELS=1
	unset SVS_LOG_PREDICTION_ERRORS
	;;
test)
	export SVS_LOG_PREDICTION_ERRORS=1
	unset SVS_SAVE_MODELS
	;;
esac
	
NCUBES=3
NSTEPS=10

for touching in `seq $((NCUBES-1))`
do
	for side in l r t b
	do
		for direction in "-1 0" "1 0" "0 -1" "0 1"
		do
			seed=`get_seed`
			env_args="$seed $NCUBES $touching $side"
			remote_args="fixed $NSTEPS $direction"
			
			#./run -g -m -r "$remote_args" -e "$env_args" "run $((NSTEPS+2))"
			./run -m -r "$remote_args" -e "$env_args" "run $((NSTEPS+2))"
			
			if [ "$?" -ne 0 ]
			then
				echo 'failed' >&2
				exit 1
			fi
		done
	done
done
